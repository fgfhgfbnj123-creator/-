

2. Створюєш **окрему віртуальну машину** з Windows (наприклад, Windows 10/11) та встановленим MS Office (trial).

3. У налаштуваннях віртуальної машини **відключаєш доступ до Інтернету** (режим мережі Host-only / Internal network).

4. У VM встановлюєш інструменти аналізу (можеш написати, що завантажено заздалегідь й перенесено в офлайн-VM):

   * Process Explorer або Process Hacker (аналіз процесів);
   * Process Monitor (Procmon) — журнал доступу до файлів/реєстру;
   * Autoruns — автозапуск;
   * Task Manager / Services / Task Scheduler — стандартні оснастки;
   * Wireshark або вбудований Network Monitor;
   * Regedit / Event Viewer для реєстру та журналів.

5. Файл KMS-активатора, який видав викладач, копіюєш у окрему папку, наприклад `C:\Lab\KMS`.
   У звіті прямо зазначаєш, що робота виконується **лише в ізольованому середовищі**.

---

## 2. Фіксація стану системи до запуску активатора

Тут твоє завдання – зібрати «зріз» системи **до** будь-якого втручання, щоб було з чим порівнювати.

### 2.1. Процеси

1. Запускаєш Process Explorer від імені адміністратора.
2. Фіксуєш поточний список процесів (можна зберегти snapshot або зробити скріншот).
3. У звіті пишеш, що знято початковий перелік процесів для подальшого порівняння.

### 2.2. Служби

1. Відкриваєш оснастку **Services** (`services.msc` через «Виконати»).
2. Переглядаєш список служб, особливо звертаючи увагу на:

   * служби, пов’язані з Office;
   * відсутність підозрілих служб на кшталт KMS / Activation.
3. Робиш один-два скріни списку (або експортуєш у файл) – це буде «до».

### 2.3. Завдання планувальника

1. Відкриваєш **Task Scheduler** (`taskschd.msc`).
2. На гілці *Task Scheduler Library* дивишся на існуючі завдання.
3. Фіксуєш скріншот — які завдання були до запуску активатора.

### 2.4. Автозапуск

1. Запускаєш Autoruns від імені адміністратора.
2. По черзі переглядаєш вкладки:

   * **Logon** (що запускається при вході користувача),
   * **Services** (служби),
   * **Scheduled Tasks** (завдання),
   * за бажанням **Drivers**.
3. Робиш скріни цих вкладок. У тексті відмічаєш, що підозрілих записів, пов’язаних із KMS, на цьому етапі немає.

### 2.5. Реєстр (служби + Office)

1. Відкриваєш **Registry Editor** (`regedit`).
2. Виділяєш гілку `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`, через контекстне меню робиш *Export* у файл `services_before.reg`.
3. Аналогічно експортуєш гілку `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office` (якщо вона є) у файл `office_before.reg`.
4. У роботі вказуєш, що ці файли будуть використані для порівняння «до/після».

### 2.6. Мережевий стан

1. Відкриваєш стандартний **Resource Monitor** або **netstat** через командний рядок (можна просто сказати «знято список відкритих портів та активних з’єднань»).
2. Фіксуєш, що на порті 1688 (типовий порт KMS) **немає** відкритих з’єднань.
3. Робиш скрін із переліком активних підключень «до».

---

## 3. Запуск KMS-активатора

### 3.1. Підготовка моніторингу

1. Відкриваєш Process Monitor (Procmon).

2. Налаштовуєш фільтр за ім’ям файлу активатора й типами операцій:

   * процеси з іменем активатора;
   * операції створення/запису файлів;
   * створення/зміна ключів реєстру.

3. Запускаєш захоплення в Procmon (кнопка «Capture»).

4. У Wireshark (або іншому sniffer) обираєш мережевий інтерфейс VM і запускаєш захоплення трафіку — щоб потім побачити, які з’єднання відкриє активатор.

### 3.2. Власне запуск

1. Через Провідник заходиш у `C:\Lab\KMS`.
2. Натискаєш правою кнопкою на файлі активатора → **Run as administrator**.
3. У вікні програми виконуєш “активацію” так, як сформульовано в завданні, але **в межах лабораторної VM**.
4. Під час роботи активатора не закриваєш Process Explorer, Procmon, Wireshark – вони мають фіксувати його поведінку.

---

## 4. Аналіз змін після запуску

Після завершення роботи активатора зупиняєш захоплення у Procmon та Wireshark, і знову повторюєш ті самі спостереження, що були «до».

### 4.1. Нові процеси й служби

1. У Process Explorer знаходиш процес активатора та його дочірні процеси (наприклад, `cmd.exe`, `cscript.exe`, тощо) — фіксуєш скрін та описуєш, які програми він запускав.
2. Знову відкриваєш **Services**, порівнюєш зі станом «до». Зазвичай з’являється нова служба, яка:

   * має назву, пов’язану з KMS/Activation;
   * запускається автоматично при старті системи;
   * вказує у властивостях на EXE-файл, розташований у системному каталозі або в каталозі активатора.
3. У звіті описуєш цю службу: її ім’я, шлях до виконуваного файлу, тип запуску (Automatic), призначення (емуляція локального KMS-сервера).

### 4.2. Завдання планувальника

1. Повторно переглядаєш **Task Scheduler**.
2. З’являється нове завдання, створене активатором. Фіксуєш:

   * назву завдання;
   * під яким користувачем воно працює;
   * тригер (коли запускається: щодня, при вході в систему тощо);
   * дію (який файл або сценарій запускається).
3. У тексті робиш висновок, що активатор забезпечує періодичну «переактивацію», тобто закріплюється в системі на постійній основі.

### 4.3. Автозапуск

1. Знову запускаєш Autoruns.
2. Порівнюєш збережені раніше скріни з поточним станом:

   * на вкладці **Logon** та **Services** можуть з’явитися нові записи, які вказують на EXE активатора або пов’язані скрипти;
   * на вкладці **Scheduled Tasks** видно те саме завдання, що й у Task Scheduler, але з детальним шляхом до файлу.
3. У звіті описуєш, що активатор додає себе або свої компоненти в автозапуск / службові процеси.

### 4.4. Зміни у реєстрі та файлах

1. У Process Monitor переглядаєш відфільтрований лог:
   – які файли були створені (найчастіше в `C:\Windows\`, `C:\ProgramData\`, `%TEMP%`);
   – які ключі реєстру змінювалися (особливо гілки, пов’язані з Office і службами).
2. Через Regedit порівнюєш експортовані раніше файли `services_before.reg` / `services_after.reg` і `office_before.reg` / `office_after.reg` (можна через будь-який diff-інструмент).
3. У звіті виписуєш ключові відмінності:

   * нові ключі, що визначають щойно створену службу;
   * зміни в параметрах ліцензування Office (адреса KMS-сервера, тип ліцензії тощо);
   * за потреби – зміни в файлі `hosts` або правилах брандмауера (якщо вони помітні в Procmon / журналах).

### 4.5. Мережева активність

1. У Wireshark аналізуєш захоплений трафік під час роботи активатора.

   * шукаєш пакети з портом **1688** — ознака роботи KMS-протоколу;
   * перевіряєш, чи є з’єднання з 127.0.0.1 (локальний KMS-сервер) або з зовнішніми IP-адресами.
2. У звіті можна навести фрагмент трафіку (скрін), де видно, що активатор:

   * або відкриває власний KMS-сервер локально,
   * або намагається підключитися до сторонніх серверів у мережі.

---

## 5. Узагальнення та аналіз ризиків

У розділі «Аналіз результатів» та «Висновки» ти описуєш:

1. Що KMS-активатор **не просто одноразово змінює параметри Office**, а:

   * створює нову службу, яка автоматично запускається при старті Windows;
   * додає завдання у планувальник завдань для періодичної активації;
   * змінює реєстр у частині, пов’язаній з ліцензуванням Office і конфігурацією KMS-серверу;
   * може модифікувати файл `hosts` або правила брандмауера, блокуючи легітимні сервери Microsoft.

2. Що мережевий аналіз показує:

   * використання порту 1688 та імітацію KMS-серверу;
   * потенційні з’єднання з невідомими зовнішніми адресами (що створює ризик витоку даних або установки додаткового шкідливого ПЗ).

3. З точки зору **інформаційної безпеки**:

   * така програма порушує модель довіри, бо втручається в системні механізми ліцензування без контролю користувача;
   * створює додаткові точки атаки (служби з правами SYSTEM, завдання в планувальнику, відкриті порти);
   * може використовуватися як канал для розповсюдження іншого шкідливого ПЗ.

4. З точки зору **закону і ліцензій**:

   * використання KMS-активаторів порушує ліцензійну угоду Microsoft;
   * у корпоративному середовищі це може привести до юридичних наслідків і порушення політики безпеки.

---

У такому вигляді в тебе буде:

* чіткий покроковий опис «що робив»;
* скріни/експорти до та після;
* аналіз того, як саме активатор змінює систему й чому це небезпечно.
